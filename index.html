<!DOCTYPE html>

<html lang="pt-br" ng-app>
	<style type="text/css">
		body {	background: silver; }
		
		#searchuser { width:300px; height:40px; border-radius: 10px; }
		
	</style>

	<head> 
		<!--<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.0.8/angular.min.js"></script>
		<link rel="stylesheet" type="text/css" media="all" href="styles.css">-->
  		<script type="text/javascript" src="jquery-1.10.2.min.js"></script>

		<!--<script src="https://api.github.com"></script>-->
	</head>

	<body ng-controller="CtrlSearch">
		<div class="header" align="center">
			<div id="divLogo">
				<img id=imglogo src="github-logo.png"/> 
			</div>
			<div id=divBusca>
				<input type="text" id="searchuser" ng-model="username" placeholder="Buscar usuÃ¡rios ..."/>
				<a href="" id="submit" ng-click="getUserInfo()">teste</a>
			</div>
		</div>

		<div class="load" align="center"></div>

		<script type="text/javascript">
			function CtrlSearch($scope, $http)
			{
   				$scope.getUserInfo = function()
   				{
   					$scope.userNotFound = false;
   					$scope.loaded = false;
 
   					$http.get("https://api.github.com/users/" + $scope.username)
   					.success(function (data) 
   						{
   							$scope.user = data;
         					$scope.loaded = true;
      					}
      				)
      				.error(function ()
      					{
      						$scope.userNotFound = true;
      					}
      				)
   				}
			}

			$('#submit').on('click', function(e)
				{
					e.preventDefault();
					$('#load').html('<div id="loader"><img src="loader.gif"></div>');
 
    				var username = $('#username').val();
    				var requri   = 'https://api.github.com/users/'+username;
    				var repouri  = 'https://api.github.com/users/'+username+'/repos';

    				requestJSON(requri, function(json)
    					{
    						if(json.message == "Not Found" || username == '')
    						{
    							$('#load').html("<h2>No User Info Found</h2>");
        					}
 
        					else
        					{
            					var fullname   = json.name;
            					var username   = json.login;
            					var aviurl     = json.avatar_url;
            					var profileurl = json.html_url;
            					var location   = json.location;
            					var followersnum = json.followers;
            					var followingnum = json.following;
            					var reposnum     = json.public_repos;

            					if(fullname == undefined)
            					{ 
            						fullname = username; 
            					}
 
            					var outhtml = '<h2>'+fullname+' <span class="smallname">(@<a href="'+profileurl+'" target="_blank">'+username+'</a>)</span></h2>';
            					outhtml = outhtml + '<div class="ghcontent"><div class="avi"><a href="'+profileurl+'" target="_blank"><img src="'+aviurl+'" width="80" height="80" alt="'+username+'"></a></div>';
            					outhtml = outhtml + '<p>Followers: '+followersnum+' - Following: '+followingnum+'<br>Repos: '+reposnum+'</p></div>';
            					outhtml = outhtml + '<div class="repolist clearfix">';

            					var repositories;
        						$.getJSON(repouri, function(json)
        							{
        								repositories = json;   
          								outputPageContent();                
        							}
        						); 

        						function outputPageContent()
        						{
          							if(repositories.length == 0)
          							{ 
          								outhtml = outhtml + '<p>No repos!</p></div>'; 
          							}
          							else 
          							{
            							outhtml = outhtml + '<p><strong>Repos List:</strong></p> <ul>';
            							$.each(repositories, function(index) 
            								{
              									outhtml = outhtml + '<li><a href="'+ repositories[index].html_url + '"target="_blank">' + repositories[index].name +'</a></li>';
            								}
            							);
            							outhtml = outhtml + '</ul></div>'; 
          							}

          							$('#load').html(outhtml);
        						}// fim outputPageContent()
      						} // sim else
    					}
    				); // fim requestJSON Ajax call
  				}
  			); // sim click event handler

		</script>


	</body>
</html>